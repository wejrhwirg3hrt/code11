<!DOCTYPE html>
<html lang="zh-CN" xmlns:th="http://www.thymeleaf.org" xmlns:sec="http://www.w3.org/1999/xhtml">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ËßÜÈ¢ëÁΩëÁ´ô - ÂèëÁé∞Á≤æÂΩ©ËßÜÈ¢ë</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <link href="/css/smart-pet.css" rel="stylesheet">
    <link href="/css/online-status.css" rel="stylesheet">
    <style>
        :root {
            --primary-gradient: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            --secondary-gradient: linear-gradient(135deg, #f093fb 0%, #f5576c 100%);
            --success-gradient: linear-gradient(135deg, #4facfe 0%, #00f2fe 100%);
        }

        body {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            background-color: #f8f9fa;
            margin: 0;
            padding: 0;
        }

        /* ‰∏ªÂÆπÂô®Â±Ö‰∏≠ */
        .main-container {
            width: 100%;
            max-width: 1400px;
            margin: 0 auto;
            padding: 0 20px;
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        .hero-section {
            background: #fff;
            padding: 2rem 0;
            border-bottom: 1px solid #e9ecef;
        }

        .search-box {
            background: #fff;
            border-radius: 25px;
            padding: 0.5rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            border: 1px solid #e9ecef;
        }

        .category-card {
            background: white;
            border-radius: 20px;
            padding: 1.5rem;
            text-align: center;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            cursor: pointer;
            height: 100%;
        }

        .category-card:hover {
            transform: translateY(-10px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .category-icon {
            font-size: 2.5rem;
            margin-bottom: 1rem;
            display: block;
        }

        .video-card {
            background: white;
            border-radius: 20px;
            overflow: hidden;
            transition: all 0.3s ease;
            border: none;
            box-shadow: 0 5px 20px rgba(0,0,0,0.1);
            height: 100%;
            display: flex;
            flex-direction: column;
        }

        .video-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 15px 40px rgba(0,0,0,0.2);
        }

        .video-thumbnail {
            height: 200px;
            object-fit: cover;
            width: 100%;
        }

        .video-card .card-body {
            flex: 1;
            display: flex;
            flex-direction: column;
        }

        .video-card .card-content {
            flex: 1;
        }

        .video-card .card-footer-actions {
            margin-top: auto;
        }

        .user-avatar-small {
            width: 32px;
            height: 32px;
            border-radius: 50%;
            background: var(--primary-gradient);
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 0.8rem;
            overflow: hidden;
        }

        .user-avatar-small img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .stats-badge {
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 0.25rem 0.5rem;
            border-radius: 15px;
            font-size: 0.8rem;
            margin: 0 0.25rem;
        }

        .floating-action {
            position: fixed;
            bottom: 2rem;
            right: 2rem;
            z-index: 1000;
        }

        .gradient-btn {
            background: var(--primary-gradient);
            border: none;
            color: white;
            padding: 0.75rem 2rem;
            border-radius: 50px;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        .gradient-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 10px 25px rgba(102, 126, 234, 0.4);
            color: white;
        }

        .section-title {
            font-size: 2rem;
            font-weight: 700;
            margin-bottom: 2rem;
            position: relative;
            display: inline-block;
        }

        .section-title::after {
            content: '';
            position: absolute;
            bottom: -10px;
            left: 0;
            width: 50px;
            height: 4px;
            background: var(--primary-gradient);
            border-radius: 2px;
        }

        .navbar-brand {
            font-weight: 700;
            font-size: 1.3rem;
        }

        /* ÂØºËà™Ê†è‰ºòÂåñÊ†∑Âºè */
        .nav-link-sm {
            font-size: 0.85rem !important;
            padding: 0.4rem 0.6rem !important;
            white-space: nowrap;
        }

        .btn-nav-sm {
            font-size: 0.8rem !important;
            padding: 0.3rem 0.6rem !important;
        }

        .navbar-text-sm {
            font-size: 0.85rem !important;
        }

        .navbar-nav .nav-link {
            transition: all 0.2s ease;
        }

        .navbar-nav .nav-link:hover {
            transform: translateY(-1px);
            color: #fff !important;
        }

        /* ÂØºËà™Ê†è‰∏âÂàÜÂ∏ÉÂ±Ä */
        .navbar-left {
            flex: 0 0 auto;
            border-right: 1px solid rgba(255, 255, 255, 0.2);
            padding-right: 1rem;
            margin-right: 1rem;
        }

        .navbar-center {
            flex: 0 0 auto;
            padding: 0 1rem;
            border-left: 1px solid rgba(255, 255, 255, 0.2);
            border-right: 1px solid rgba(255, 255, 255, 0.2);
        }

        .navbar-right {
            flex: 0 0 auto;
            padding-left: 1rem;
            margin-left: 1rem;
            border-left: 1px solid rgba(255, 255, 255, 0.2);
        }

        /* Á≠æÂà∞ÊåâÈíÆÁâπÊÆäÊ†∑Âºè */
        #checkinBtn {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            font-weight: 600;
            transition: all 0.3s ease;
        }

        #checkinBtn:hover {
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(102, 126, 234, 0.4);
        }

        /* ÂìçÂ∫îÂºè‰ºòÂåñ */
        @media (max-width: 1400px) {
            .navbar-left, .navbar-center, .navbar-right {
                padding: 0 0.5rem;
                margin: 0 0.5rem;
            }
        }

        @media (max-width: 1200px) {
            .nav-link-sm {
                font-size: 0.8rem !important;
                padding: 0.3rem 0.4rem !important;
            }

            .btn-nav-sm {
                font-size: 0.75rem !important;
                padding: 0.25rem 0.5rem !important;
            }

            .navbar-left, .navbar-center, .navbar-right {
                border: none;
                padding: 0 0.25rem;
                margin: 0 0.25rem;
            }
        }

        @media (max-width: 992px) {
            .navbar-left, .navbar-center, .navbar-right {
                flex-direction: column;
                align-items: center;
            }
        }

        .announcement-modern {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 15px;
            margin-bottom: 2rem;
        }

        .announcement-modern .alert-heading {
            color: white;
        }

        .btn-close-white {
            filter: invert(1);
        }

        /* ÂØºËà™Ê†èÊêúÁ¥¢Ê†∑Âºè */
        .navbar-search {
            max-width: 400px;
            width: 100%;
        }

        .navbar-search-input {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.2);
            color: white;
            border-radius: 25px 0 0 25px;
        }

        .navbar-search-input::placeholder {
            color: rgba(255,255,255,0.7);
        }

        .navbar-search-input:focus {
            background: rgba(255,255,255,0.15);
            border-color: rgba(255,255,255,0.3);
            color: white;
            box-shadow: none;
        }

        .navbar-search .btn {
            border-radius: 0 25px 25px 0;
            border-left: none;
        }

        @media (max-width: 768px) {
            .navbar-search {
                max-width: 200px;
            }
        }

        /* Áé∞‰ª£ÂåñÈ°µËÑöÊ†∑Âºè */
        .footer-modern {
            background: linear-gradient(135deg, #2c3e50 0%, #34495e 100%);
            color: white;
            padding: 4rem 0 2rem;
            margin-top: 5rem;
        }

        .footer-brand h5 {
            color: white;
            margin-bottom: 1rem;
            text-align: center;
        }

        .footer-description {
            color: rgba(255,255,255,0.8);
            line-height: 1.6;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        .social-links {
            display: flex;
            justify-content: center;
            gap: 12px;
        }

        .social-link {
            width: 40px;
            height: 40px;
            background: rgba(255,255,255,0.1);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .social-link:hover {
            background: var(--primary-gradient);
            color: white;
            transform: translateY(-3px);
        }

        .footer-title {
            color: white;
            font-weight: 600;
            margin-bottom: 1.5rem;
            position: relative;
            padding-bottom: 0.5rem;
        }

        .footer-title::after {
            content: '';
            position: absolute;
            bottom: 0;
            left: 50%;
            transform: translateX(-50%);
            width: 30px;
            height: 2px;
            background: var(--primary-gradient);
            border-radius: 2px;
        }

        .footer-section {
            height: 100%;
            display: flex;
            flex-direction: column;
            padding: 0 1rem;
            text-align: center;
        }

        .footer-links {
            flex: 1;
            list-style: none;
            padding: 0;
            margin: 0;
        }

        .footer-links li {
            margin-bottom: 0.75rem;
            text-align: center;
        }

        .footer-links a {
            display: inline-flex;
            align-items: center;
            justify-content: center;
            color: rgba(255,255,255,0.8);
            text-decoration: none;
            transition: all 0.3s ease;
            padding: 0.25rem 0;
        }

        .footer-links a:hover {
            color: #f093fb;
            transform: translateY(-2px);
        }

        .stat-item {
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 12px;
            margin-bottom: 1rem;
            text-align: center;
        }

        .stat-item i {
            font-size: 1.2rem;
        }

        .stat-number {
            font-size: 1.1rem;
            font-weight: 600;
            color: white;
        }

        .stat-label {
            font-size: 0.85rem;
            color: rgba(255,255,255,0.7);
        }

        .footer-stats {
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 0.5rem;
        }

        .footer-bottom {
            border-top: 1px solid rgba(255,255,255,0.1);
            margin-top: 3rem;
            padding-top: 2rem;
        }

        .copyright-text {
            color: rgba(255,255,255,0.8);
            margin: 0;
        }

        .footer-badges .badge {
            font-size: 0.8rem;
            padding: 0.5rem 1rem;
        }

        /* ÊúÄËøëÊàêÂ∞±Ê†∑Âºè */
        .recent-achievements-card {
            background: rgba(255, 255, 255, 0.95);
            border-radius: 20px;
            padding: 1.5rem;
            box-shadow: 0 10px 40px rgba(0,0,0,0.1);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255,255,255,0.2);
        }

        .achievement-item-recent {
            display: flex;
            align-items: center;
            padding: 0.75rem;
            margin-bottom: 0.5rem;
            background: rgba(255,255,255,0.8);
            border-radius: 12px;
            transition: all 0.3s ease;
            border-left: 4px solid transparent;
        }

        .achievement-item-recent:hover {
            transform: translateX(5px);
            box-shadow: 0 5px 15px rgba(0,0,0,0.1);
        }

        .achievement-item-recent.unlocked {
            border-left-color: #28a745;
        }

        .achievement-icon-recent {
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            margin-right: 0.75rem;
            font-size: 1rem;
            background: linear-gradient(45deg, #28a745, #20c997);
            color: white;
        }

        .achievement-info-recent {
            flex-grow: 1;
        }

        .achievement-name-recent {
            font-weight: 600;
            font-size: 0.9rem;
            margin-bottom: 0.25rem;
            color: #333;
        }

        .achievement-desc-recent {
            font-size: 0.8rem;
            color: #666;
            margin-bottom: 0;
        }

        .achievement-status-recent {
            font-size: 0.75rem;
            color: #28a745;
            font-weight: 500;
        }

        @media (max-width: 768px) {
            .footer-modern {
                padding: 3rem 0 1.5rem;
            }

            .social-links {
                justify-content: center;
                margin-top: 1rem;
            }

            .footer-stats {
                flex-direction: row;
                justify-content: space-around;
                flex-wrap: wrap;
            }

            .stat-item {
                flex-direction: column;
                text-align: center;
                gap: 4px;
            }
        }

        /* Á¥ßÂáëÁâàHero Section */
        .hero-section-compact {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            padding: 2rem 0;
        }

        .hero-title-compact {
            font-size: 2rem;
            font-weight: 700;
            color: white;
        }

        .hero-subtitle-compact {
            font-size: 1.1rem;
            color: rgba(255,255,255,0.9);
        }

        .hero-actions-compact .btn {
            border-radius: 25px;
            padding: 0.6rem 1.5rem;
            font-weight: 500;
        }

        .search-box-compact {
            background: rgba(255,255,255,0.1);
            border-radius: 50px;
            padding: 0.5rem;
            backdrop-filter: blur(10px);
        }

        .search-input-compact {
            background: transparent;
            border: none;
            color: white;
            border-radius: 25px;
        }

        .search-input-compact::placeholder {
            color: rgba(255,255,255,0.8);
        }

        .search-input-compact:focus {
            background: rgba(255,255,255,0.1);
            border: none;
            color: white;
            box-shadow: none;
        }

        .search-btn-compact {
            border-radius: 50%;
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: rgba(255,255,255,0.2);
            border: none;
            color: white;
        }

        .search-btn-compact:hover {
            background: rgba(255,255,255,0.3);
            color: white;
        }

        /* ËßÜÈ¢ëÂØºËà™Ê†∑Âºè */
        .video-nav-section {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 15px;
            padding: 20px;
            margin-bottom: 30px;
        }

        .video-nav-container {
            color: white;
        }

        .video-nav-header {
            display: flex;
            justify-content: space-between;
            align-items: center;
            margin-bottom: 20px;
        }

        .sort-dropdown select {
            background: rgba(255,255,255,0.1);
            border: 1px solid rgba(255,255,255,0.3);
            color: white;
            border-radius: 8px;
            padding: 8px 15px;
        }

        .sort-dropdown select option {
            background: #333;
            color: white;
        }

        .category-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
        }

        .category-tag {
            background: rgba(255,255,255,0.1);
            color: white;
            padding: 8px 16px;
            border-radius: 20px;
            text-decoration: none;
            font-size: 0.9rem;
            transition: all 0.3s ease;
            border: 1px solid rgba(255,255,255,0.2);
        }

        .category-tag:hover,
        .category-tag.active {
            background: rgba(255,255,255,0.2);
            color: white;
            transform: translateY(-2px);
        }

        /* ËßÜÈ¢ëÁΩëÊ†ºÊ†∑Âºè */
        .video-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 20px;
            padding: 0;
        }

        .video-item {
            background: white;
            border-radius: 12px;
            overflow: hidden;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            transition: all 0.3s ease;
            border: 1px solid #f0f0f0;
        }

        .video-item:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .video-thumbnail-container {
            position: relative;
            overflow: hidden;
        }

        .video-thumbnail-modern {
            width: 100%;
            height: 180px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .video-item:hover .video-thumbnail-modern {
            transform: scale(1.05);
        }

        .video-duration {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0,0,0,0.8);
            color: white;
            padding: 4px 8px;
            border-radius: 4px;
            font-size: 0.8rem;
            font-weight: 500;
        }

        .video-views {
            position: absolute;
            top: 8px;
            right: 8px;
            background: rgba(0,0,0,0.7);
            color: white;
            padding: 4px 8px;
            border-radius: 15px;
            font-size: 0.8rem;
            display: flex;
            align-items: center;
            gap: 4px;
        }

        .play-overlay {
            position: absolute;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background: rgba(0,0,0,0.7);
            color: white;
            width: 60px;
            height: 60px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 1.5rem;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .video-item:hover .play-overlay {
            opacity: 1;
        }

        .video-info-modern {
            padding: 15px;
        }

        .video-title-modern {
            font-size: 1rem;
            font-weight: 600;
            margin-bottom: 10px;
            line-height: 1.4;
        }

        .video-title-modern a {
            color: #333;
            text-decoration: none;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .video-title-modern a:hover {
            color: #007bff;
        }

        .video-author {
            display: flex;
            align-items: center;
            gap: 8px;
            margin-bottom: 10px;
        }

        .author-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            overflow: hidden;
            background: #f0f0f0;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .author-avatar img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .author-name {
            font-size: 0.85rem;
            color: #666;
            font-weight: 500;
        }

        .video-stats {
            display: flex;
            gap: 15px;
            margin-bottom: 10px;
        }

        .stat-item {
            display: flex;
            align-items: center;
            gap: 4px;
            font-size: 0.8rem;
            color: #888;
        }

        .video-tags {
            display: flex;
            flex-wrap: wrap;
            gap: 5px;
        }

        .video-tag {
            background: #f8f9fa;
            color: #666;
            padding: 2px 8px;
            border-radius: 10px;
            font-size: 0.75rem;
            border: 1px solid #e9ecef;
        }

        /* ÊêúÁ¥¢Ê°ÜÊ†∑Âºè */
        .search-box-compact {
            margin-top: 20px;
        }

        .search-input-compact {
            border-radius: 25px;
            padding: 12px 20px;
            border: 2px solid rgba(255,255,255,0.4);
            background: rgba(255,255,255,0.98);
            font-size: 16px;
            transition: all 0.3s ease;
            color: #333;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }

        .search-input-compact::placeholder {
            color: #555;
            font-weight: 600;
            opacity: 1;
            font-size: 15px;
        }

        .search-input-compact:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
            background: white;
            color: #333;
        }

        .search-input-compact:focus::placeholder {
            color: #999;
            opacity: 0.8;
        }

        .search-btn-compact {
            border-radius: 25px;
            padding: 12px 20px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border: none;
            color: white;
            transition: all 0.3s ease;
        }

        .search-btn-compact:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            color: white;
        }



        /* ÊêúÁ¥¢Âª∫ËÆÆ‰∏ãÊãâÊ°ÜÊ†∑Âºè */
        .search-input-container {
            position: relative;
        }

        .search-suggestions-dropdown {
            position: absolute;
            top: 100%;
            left: 0;
            right: 0;
            background: white;
            border: 1px solid #ddd;
            border-top: none;
            border-radius: 0 0 15px 15px;
            box-shadow: 0 4px 15px rgba(0,0,0,0.1);
            z-index: 1000;
            max-height: 300px;
            overflow-y: auto;
            display: none;
        }

        .search-suggestion-item {
            padding: 12px 20px;
            cursor: pointer;
            border-bottom: 1px solid #f0f0f0;
            transition: background-color 0.2s ease;
            display: flex;
            align-items: center;
        }

        .search-suggestion-item:hover,
        .search-suggestion-item.active {
            background-color: #f8f9fa;
        }

        .search-suggestion-item:last-child {
            border-bottom: none;
        }

        .search-suggestion-icon {
            margin-right: 10px;
            color: #6c757d;
            width: 16px;
        }

        .search-suggestion-text {
            flex-grow: 1;
            color: #333;
        }

        .search-suggestion-type {
            font-size: 0.8em;
            color: #6c757d;
            margin-left: 10px;
        }

        /* Êé®ËçêÂå∫ÂüüÊ†∑Âºè */
        .recommendation-section {
            background: linear-gradient(135deg, #f8f9fa 0%, #e9ecef 100%);
            border-radius: 20px;
            padding: 2rem;
            margin-bottom: 2rem;
        }

        .section-title {
            color: #495057;
            font-weight: 600;
            margin-bottom: 0;
        }

        .recommendation-card {
            background: white;
            border-radius: 15px;
            overflow: hidden;
            transition: all 0.3s ease;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
            height: 100%;
        }

        .recommendation-card:hover {
            transform: translateY(-5px);
            box-shadow: 0 8px 25px rgba(0,0,0,0.15);
        }

        .video-thumbnail-container {
            position: relative;
            overflow: hidden;
        }

        .video-thumbnail {
            width: 100%;
            height: 120px;
            object-fit: cover;
            transition: transform 0.3s ease;
        }

        .video-duration {
            position: absolute;
            bottom: 8px;
            right: 8px;
            background: rgba(0, 0, 0, 0.8);
            color: white;
            padding: 2px 6px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: 500;
        }

        .author-avatar {
            width: 24px;
            height: 24px;
            border-radius: 50%;
            object-fit: cover;
        }

        .default-avatar {
            width: 100%;
            height: 100%;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            color: white;
            font-size: 12px;
        }

        .author-name {
            font-size: 0.8rem;
            color: #666;
            font-weight: 500;
        }

        .video-author {
            margin-bottom: 8px;
        }

        .video-time {
            margin-top: 8px;
        }

        .recommendation-card:hover .video-thumbnail {
            transform: scale(1.05);
        }

        .video-overlay {
            position: absolute;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background: rgba(0,0,0,0.3);
            display: flex;
            align-items: center;
            justify-content: center;
            opacity: 0;
            transition: opacity 0.3s ease;
        }

        .recommendation-card:hover .video-overlay {
            opacity: 1;
        }

        .play-btn {
            background: rgba(255,255,255,0.9);
            color: #667eea;
            width: 40px;
            height: 40px;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            text-decoration: none;
            transition: all 0.3s ease;
        }

        .play-btn:hover {
            background: white;
            color: #667eea;
            transform: scale(1.1);
        }

        .recommendation-info {
            padding: 1rem;
        }

        .recommendation-info .video-title {
            font-size: 0.9rem;
            font-weight: 600;
            color: #333;
            margin-bottom: 0.5rem;
            line-height: 1.3;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
            color: #333;
        }

        .video-meta {
            display: flex;
            justify-content: space-between;
            font-size: 0.8rem;
            color: #6c757d;
        }

        .video-meta span {
            display: flex;
            align-items: center;
        }

        /* Áé∞‰ª£ÂåñÂàÜÈ°µÊ†∑Âºè */
        .pagination-modern-container {
            background: white;
            border-radius: 15px;
            padding: 25px;
            margin: 40px 0;
            box-shadow: 0 4px 20px rgba(0,0,0,0.1);
            border: 1px solid #f0f0f0;
        }

        .pagination-modern {
            display: flex;
            justify-content: center;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }

        .pagination-btn {
            display: flex;
            align-items: center;
            gap: 8px;
            padding: 10px 16px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
            border: none;
        }

        .pagination-btn:hover {
            transform: translateY(-2px);
            box-shadow: 0 4px 15px rgba(102, 126, 234, 0.4);
            color: white;
        }

        .pagination-btn.disabled {
            background: #e9ecef;
            color: #6c757d;
            cursor: not-allowed;
            transform: none;
            box-shadow: none;
        }

        .pagination-numbers {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .pagination-number {
            width: 40px;
            height: 40px;
            display: flex;
            align-items: center;
            justify-content: center;
            background: #f8f9fa;
            color: #495057;
            text-decoration: none;
            border-radius: 8px;
            font-weight: 500;
            transition: all 0.3s ease;
            border: 1px solid #dee2e6;
        }

        .pagination-number:hover {
            background: #e9ecef;
            color: #495057;
            transform: translateY(-1px);
        }

        .pagination-number.active {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border-color: transparent;
        }

        .pagination-ellipsis {
            padding: 0 8px;
            color: #6c757d;
            font-weight: 500;
        }

        .pagination-info {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 20px;
            border-top: 1px solid #f0f0f0;
        }

        .pagination-stats {
            color: #6c757d;
            font-size: 0.9rem;
        }

        .stats-text strong {
            color: #495057;
            font-weight: 600;
        }

        .pagination-jump {
            display: flex;
            align-items: center;
            gap: 8px;
            font-size: 0.9rem;
            color: #6c757d;
        }

        .jump-input {
            width: 60px;
            padding: 6px 10px;
            border: 1px solid #dee2e6;
            border-radius: 6px;
            text-align: center;
            font-size: 0.9rem;
        }

        .jump-input:focus {
            outline: none;
            border-color: #667eea;
            box-shadow: 0 0 0 2px rgba(102, 126, 234, 0.2);
        }

        .jump-btn {
            width: 32px;
            height: 32px;
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            border: none;
            border-radius: 6px;
            display: flex;
            align-items: center;
            justify-content: center;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .jump-btn:hover {
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(102, 126, 234, 0.4);
        }

        @media (max-width: 768px) {
            .hero-section-compact {
                padding: 1.5rem 0;
            }

            .hero-title-compact {
                font-size: 1.5rem;
            }

            .hero-subtitle-compact {
                font-size: 1rem;
            }

            .search-box-compact {
                margin-top: 1rem;
            }

            .video-grid {
                grid-template-columns: repeat(auto-fill, minmax(280px, 1fr));
                gap: 15px;
            }

            .video-nav-header {
                flex-direction: column;
                gap: 15px;
                align-items: stretch;
            }

            .category-tags {
                justify-content: center;
            }
        }

        /* Áé∞‰ª£ÂåñÂàÜÈ°µÊ†∑Âºè - Á¥ßÂáëÁâàÊú¨ */
        .pagination-container {
            background: white;
            border-radius: 12px;
            padding: 16px 20px;
            box-shadow: 0 2px 12px rgba(0,0,0,0.08);
            border: 1px solid #f0f0f0;
            margin: 1.5rem auto 1rem auto;
            max-width: 100%;
        }

        .pagination-modern {
            gap: 8px;
        }

        .pagination-modern .page-link {
            border: none;
            border-radius: 8px;
            padding: 10px 14px;
            color: #6c757d;
            background: #f8f9fa;
            transition: all 0.3s ease;
            font-weight: 500;
            min-width: 44px;
            text-align: center;
            font-size: 14px;
            text-decoration: none;
        }

        .pagination-modern .page-link:hover {
            background: #e9ecef;
            color: #495057;
            transform: translateY(-1px);
            box-shadow: 0 2px 8px rgba(0,0,0,0.1);
        }

        .pagination-modern .page-item.active .page-link {
            background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
            color: white;
            box-shadow: 0 2px 10px rgba(102, 126, 234, 0.3);
        }

        .pagination-modern .page-item.disabled .page-link {
            background: #f8f9fa;
            color: #adb5bd;
            cursor: not-allowed;
        }

        .pagination-modern .page-prev,
        .pagination-modern .page-next {
            padding: 12px 20px;
            font-weight: 600;
        }

        .pagination-info {
            color: #6c757d;
            font-size: 14px;
        }

        .pagination-info strong {
            color: #495057;
            font-weight: 600;
        }

        .page-size-selector .form-select {
            border-radius: 12px;
            border: 1px solid #e9ecef;
            padding: 8px 12px;
            font-size: 14px;
            color: #6c757d;
            background-color: #f8f9fa;
            transition: all 0.3s ease;
        }

        .page-size-selector .form-select:focus {
            border-color: #667eea;
            box-shadow: 0 0 0 0.2rem rgba(102, 126, 234, 0.25);
            background-color: white;
        }

        /* ÂìçÂ∫îÂºèÂàÜÈ°µ */
        @media (max-width: 768px) {
            .pagination-container .d-flex {
                flex-direction: column;
                gap: 16px;
                text-align: center;
            }

            .pagination-modern .page-link {
                padding: 10px 12px;
                min-width: 40px;
                font-size: 14px;
            }

            .pagination-modern {
                justify-content: center;
            }
        }

        @media (max-width: 576px) {
            .pagination-modern .page-link {
                padding: 8px 10px;
                min-width: 36px;
                font-size: 13px;
            }
        }

    </style>
</head>
<body>
<nav class="navbar navbar-expand-lg navbar-dark bg-dark">
    <div class="container">
        <a class="navbar-brand" href="/">
            <i class="fas fa-video me-2"></i>ËßÜÈ¢ëÁΩëÁ´ô
        </a>



        <div class="navbar-nav ms-auto d-flex flex-row align-items-center w-100">
            <!-- ÁôªÂΩïÁä∂ÊÄÅ‰∏ãÊòæÁ§∫ -->
            <div sec:authorize="isAuthenticated()" class="d-flex flex-row align-items-center w-100 justify-content-between"
                 data-current-user-id="${#authentication.principal.id}"
                 data-current-username="${#authentication.principal.username}">
                <!-- Â∑¶‰æßÂäüËÉΩÂå∫ -->
                <div class="d-flex flex-row align-items-center navbar-left">
                    <!-- Âú®Á∫øÁî®Êà∑ÁªüËÆ° -->
                    <div class="online-stats me-3">
                        <i class="fas fa-circle online-icon"></i>
                        <span class="online-count">0</span> Âú®Á∫ø
                    </div>

                    <a class="nav-link me-2 nav-link-sm" href="/chat">
                        <i class="fas fa-comments me-1"></i>ËÅäÂ§©
                        <span class="badge bg-danger ms-1" id="chatUnreadBadge" style="display: none;">0</span>
                    </a>
                    <a class="nav-link me-2 nav-link-sm" href="/upload">
                        <i class="fas fa-upload me-1"></i>‰∏ä‰º†
                    </a>
                    <a class="nav-link me-2 nav-link-sm" href="/music">
                        <i class="fas fa-music me-1"></i>Èü≥‰πê
                    </a>
                    <a class="nav-link me-2 nav-link-sm" href="/posts">
                        <i class="fas fa-heart me-1"></i>Âä®ÊÄÅ
                    </a>
                    <a class="nav-link me-2 nav-link-sm" href="/private-album">
                        <i class="fas fa-lock me-1"></i>ÁßÅÂØÜÁõ∏ÂÜå
                    </a>
                    <a class="nav-link me-2 nav-link-sm" href="/voice-clone">
                        <i class="fas fa-microphone me-1"></i>ËØ≠Èü≥ÂÖãÈöÜ
                    </a>
                </div>

                <!-- ‰∏≠Èó¥Á≠æÂà∞Âå∫ -->
                <div class="navbar-center">
                    <button class="btn btn-outline-light btn-sm btn-nav-sm" id="checkinBtn" onclick="dailyCheckin()">
                        <i class="fas fa-calendar-check me-1"></i>Á≠æÂà∞
                    </button>
                </div>

                <!-- Âè≥‰æßÁî®Êà∑Âå∫ -->
                <div class="d-flex flex-row align-items-center navbar-right">
                    <a class="nav-link me-2 nav-link-sm notification-bell" href="/notifications">
                        <i class="fas fa-bell me-1"></i>ÈÄöÁü•
                        <span class="badge bg-danger notification-badge" style="display: none;">0</span>
                    </a>
                    <a class="nav-link me-2 nav-link-sm" href="/profile" id="userProfileLink">
                        <i class="fas fa-user me-1"></i>ÊàëÁöÑ‰∏ªÈ°µ
                        <span id="userLevelBadge" class="badge bg-primary ms-1" style="display: none;"></span>
                    </a>
                    <span class="navbar-text me-2 navbar-text-sm">
                        <i class="fas fa-user me-1"></i><span sec:authentication="name"></span>
                    </span>
                    <form th:action="@{/logout}" method="post" style="display: inline;">
                        <button class="btn btn-outline-light btn-sm btn-nav-sm" type="submit">ÈÄÄÂá∫</button>
                    </form>
                </div>
            </div>

            <!-- Êú™ÁôªÂΩïÁä∂ÊÄÅ‰∏ãÊòæÁ§∫ -->
            <div sec:authorize="!isAuthenticated()" class="d-flex flex-row align-items-center">
                <a class="nav-link me-2 nav-link-sm" href="/login">
                    <i class="fas fa-sign-in-alt me-1"></i>ÁôªÂΩï
                </a>
                <a class="nav-link nav-link-sm" href="/register">
                    <i class="fas fa-user-plus me-1"></i>Ê≥®ÂÜå
                </a>
            </div>
        </div>
    </div>
</nav>

<!-- Hero Section - Á¥ßÂáëÁâà -->
<section class="hero-section-compact">
    <div class="container">
        <div class="row align-items-center py-4">
            <div class="col-lg-8">
                <div class="hero-content-compact">
                    <h2 class="hero-title-compact mb-2">ÂèëÁé∞Á≤æÂΩ©ËßÜÈ¢ë</h2>
                    <p class="hero-subtitle-compact mb-3">Êé¢Á¥¢Êó†ÈôêÂèØËÉΩÔºåÂàÜ‰∫´ÁæéÂ•ΩÊó∂ÂÖâ</p>
                    <div class="hero-actions-compact">
                        <a href="/upload" class="btn btn-primary me-2" sec:authorize="isAuthenticated()">
                            <i class="fas fa-upload me-1"></i>‰∏ä‰º†ËßÜÈ¢ë
                        </a>
                        <a href="/register" class="btn btn-outline-primary" sec:authorize="!isAuthenticated()">
                            <i class="fas fa-user-plus me-1"></i>Á´ãÂç≥Ê≥®ÂÜå
                        </a>
                    </div>
                </div>
            </div>

            <!-- ÊêúÁ¥¢Ê°Ü -->
            <div class="col-lg-4">
                <div class="search-box-compact">
                    <form action="/search" method="get" class="d-flex position-relative">
                        <div class="search-input-container position-relative flex-grow-1">
                            <input type="text"
                                   id="searchInput"
                                   name="q"
                                   class="form-control search-input-compact"
                                   placeholder="ÊêúÁ¥¢ËßÜÈ¢ë..."
                                   th:value="${param.q}"
                                   autocomplete="off">
                            <!-- ÊêúÁ¥¢Âª∫ËÆÆ‰∏ãÊãâÊ°Ü -->
                            <div id="searchSuggestions" class="search-suggestions-dropdown"></div>
                        </div>
                        <button type="submit" class="btn search-btn-compact ms-2">
                            <i class="fas fa-search"></i>
                        </button>
                    </form>
                </div>
            </div>

        </div>
    </div>
</section>

<div class="main-container mt-5">
    <!-- ‰∏™ÊÄßÂåñÊé®ËçêÂå∫Âüü -->
    <div th:if="${hasRecommendations}" class="container mb-5">
        <div class="recommendation-section">
            <div class="d-flex align-items-center justify-content-between mb-4">
                <h3 class="section-title">
                    <i class="fas fa-magic me-2"></i>
                    <span th:text="${isPersonalized ? '‰∏∫ÊÇ®Êé®Ëçê' : 'ÁÉ≠Èó®Êé®Ëçê'}">‰∏∫ÊÇ®Êé®Ëçê</span>
                </h3>
                <small class="text-muted" th:if="${isPersonalized}">
                    Âü∫‰∫éÊÇ®ÁöÑËßÇÁúãÂéÜÂè≤ÂíåÂÅèÂ•Ω
                </small>
            </div>
            <div class="row g-4">
                <div th:each="video : ${recommendedVideos}" class="col-lg-2 col-md-4 col-sm-6">
                    <div class="recommendation-card">
                        <div class="video-thumbnail-container">
                            <img th:src="${video.thumbnail != null and !#strings.isEmpty(video.thumbnail) ? video.thumbnail : (video.thumbnailPath != null and !#strings.isEmpty(video.thumbnailPath) ? video.thumbnailPath : '/images/default-thumbnail.jpg')}"
                                 class="video-thumbnail"
                                 th:alt="${video.title}"
                                 onerror="this.src='/images/default-thumbnail.jpg'">
                            <div class="video-overlay">
                                <a th:href="@{/video/{id}(id=${video.id})}"
                                   class="play-btn">
                                    <i class="fas fa-play"></i>
                                </a>
                            </div>
                            <!-- ËßÜÈ¢ëÊó∂Èïø -->
                            <div class="video-duration" th:if="${video.duration != null and !#strings.isEmpty(video.duration)}">
                                <span th:text="${video.duration}">00:00</span>
                            </div>
                        </div>
                        <div class="recommendation-info">
                            <h6 class="video-title" th:text="${#strings.abbreviate(video.title, 50)}">ËßÜÈ¢ëÊ†áÈ¢ò</h6>
                            <!-- Áî®Êà∑‰ø°ÊÅØ -->
                            <div class="video-author" th:if="${video.user != null}">
                                <div class="d-flex align-items-center mb-2">
                                    <div class="author-avatar me-2" th:if="${video.user.avatar != null and !#strings.isEmpty(video.user.avatar)}">
                                        <img th:src="${video.user.avatar}"
                                             th:alt="${video.user.username}"
                                             onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;default-avatar&quot;>üë§</div>'">
                                    </div>
                                    <div class="author-avatar me-2 default-avatar" th:unless="${video.user.avatar != null and !#strings.isEmpty(video.user.avatar)}">üë§</div>
                                    <span class="author-name" th:text="${video.user.nickname != null and !#strings.isEmpty(video.user.nickname) ? video.user.nickname : video.user.username}">Áî®Êà∑Âêç</span>
                                </div>
                            </div>
                            <div class="video-meta">
                                <span class="views">
                                    <i class="fas fa-eye me-1"></i>
                                    <span th:text="${#numbers.formatInteger(video.viewCount != null ? video.viewCount : 0, 0, 'COMMA')}">0</span>
                                </span>
                                <span class="likes">
                                    <i class="fas fa-heart me-1"></i>
                                    <span th:text="${#numbers.formatInteger(video.likeCount != null ? video.likeCount : 0, 0, 'COMMA')}">0</span>
                                </span>
                            </div>
                            <!-- ÂèëÂ∏ÉÊó∂Èó¥ -->
                            <div class="video-time" th:if="${video.createdAt != null}">
                                <small class="text-muted">
                                    <i class="fas fa-clock me-1"></i>
                                    <span th:text="${#temporals.format(video.createdAt, 'MM-dd HH:mm')}">Êó∂Èó¥</span>
                                </small>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>



    <!-- ÂÖ¨ÂëäÂå∫Âüü -->
    <div th:if="${announcements != null and !#lists.isEmpty(announcements)}" class="mb-5">
        <div th:each="announcement : ${announcements}" class="alert announcement-modern alert-dismissible fade show" role="alert">
            <div class="d-flex align-items-start">
                <i class="fas fa-bullhorn me-3 mt-1" style="font-size: 1.2rem;"></i>
                <div class="flex-grow-1">
                    <h6 class="alert-heading mb-2 fw-bold" th:text="${announcement.title}">ÂÖ¨ÂëäÊ†áÈ¢ò</h6>
                    <div th:utext="${announcement.content}" class="mb-2">ÂÖ¨ÂëäÂÜÖÂÆπ</div>
                    <small class="opacity-75">
                        <i class="fas fa-clock me-1"></i>
                        ÂèëÂ∏ÉÊó∂Èó¥Ôºö<span th:text="${#temporals.format(announcement.createdAt, 'yyyy-MM-dd HH:mm')}"></span>
                    </small>
                </div>
            </div>
            <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="ÂÖ≥Èó≠"></button>
        </div>
    </div>



    <!-- ËßÜÈ¢ëÂàÜÁ±ªÂØºËà™ -->
    <section class="video-nav-section mb-4">
        <div class="video-nav-container">
            <div class="video-nav-header">
                <h2 class="section-title">
                    <i class="fas fa-fire me-2 text-danger"></i>ÊúÄÊñ∞ËßÜÈ¢ë
                </h2>
                <div class="sort-dropdown">
                    <select class="form-select" id="sortSelect" onchange="changeSortOrder()">
                        <option value="latest">ÊúÄÊñ∞ÁöÑ</option>
                        <option value="popular">ÊúÄÁÉ≠Èó®</option>
                        <option value="views">ËßÇÁúãÊúÄÂ§ö</option>
                        <option value="likes">ÁÇπËµûÊúÄÂ§ö</option>
                    </select>
                </div>
            </div>


        </div>
    </section>

    <!-- ËßÜÈ¢ëÁΩëÊ†º -->
    <section class="video-grid-section mb-5">
        <div class="video-grid">
            <div th:each="video : ${videos}" class="video-item">
                <div class="video-card-modern">
                    <!-- ËßÜÈ¢ëÁº©Áï•Âõæ -->
                    <div class="video-thumbnail-container">
                        <a th:href="@{/video/{id}(id=${video.id})}">
                            <img th:src="${video.thumbnail != null ? video.thumbnail : 'https://via.placeholder.com/320x180'}"
                                 class="video-thumbnail-modern" alt="ËßÜÈ¢ëÁº©Áï•Âõæ">
                        </a>

                        <!-- ËßÜÈ¢ëÊó∂Èïø -->
                        <div class="video-duration">
                            <span th:text="${video.duration != null ? video.duration : '00:00'}">00:00</span>
                        </div>

                        <!-- ËßÇÁúãÊ¨°Êï∞ -->
                        <div class="video-views">
                            <i class="fas fa-eye"></i>
                            <span th:text="${video.viewCount != null ? video.viewCount : 0}">0</span>
                        </div>

                        <!-- Êí≠ÊîæÊåâÈíÆ -->
                        <div class="play-overlay">
                            <i class="fas fa-play"></i>
                        </div>
                    </div>

                    <!-- ËßÜÈ¢ë‰ø°ÊÅØ -->
                    <div class="video-info-modern">
                        <h3 class="video-title-modern">
                            <a th:href="@{/video/{id}(id=${video.id})}" th:text="${video.title}">ËßÜÈ¢ëÊ†áÈ¢ò</a>
                        </h3>

                        <!-- Áî®Êà∑‰ø°ÊÅØ -->
                        <div class="video-author" th:attr="data-user-id=${video.user != null ? video.user.id : null}">
                            <div class="author-avatar user-avatar-container">
                                <img th:if="${video.user != null and video.user.avatar != null and !#strings.isEmpty(video.user.avatar)}"
                                     th:src="${video.user.avatar}"
                                     alt="Áî®Êà∑Â§¥ÂÉè"
                                     onerror="this.style.display='none'; this.parentElement.innerHTML='<div class=&quot;default-avatar&quot;>üë§</div>'">
                                <div th:unless="${video.user != null and video.user.avatar != null and !#strings.isEmpty(video.user.avatar)}"
                                     class="default-avatar">üë§</div>
                                <!-- Âú®Á∫øÁä∂ÊÄÅÊåáÁ§∫Âô® -->
                                <div th:if="${video.user != null}" class="online-indicator offline"></div>
                            </div>
                            <div class="author-info">
                                <span class="author-name" th:text="${video.user != null ? video.user.username : 'ÂåøÂêçÁî®Êà∑'}">Áî®Êà∑Âêç</span>
                                <div th:if="${video.user != null}" class="online-status offline">Á¶ªÁ∫ø</div>
                            </div>
                        </div>

                        <!-- ËßÜÈ¢ëÁªüËÆ° -->
                        <div class="video-stats">
                            <span class="stat-item">
                                <i class="fas fa-heart"></i>
                                <span th:text="${video.likeCount != null ? video.likeCount : 0}">0</span>
                            </span>
                            <span class="stat-item">
                                <i class="fas fa-calendar"></i>
                                <span th:text="${#temporals.format(video.createdAt, 'MM-dd')}">Êó•Êúü</span>
                            </span>
                        </div>

                        <!-- ËßÜÈ¢ëÊ†áÁ≠æ -->
                        <div th:if="${video.tagsString}" class="video-tags">
                            <span th:each="tag : ${#strings.listSplit(video.tagsString, ',')}"
                                  class="video-tag" th:text="${tag}">Ê†áÁ≠æ</span>
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </section>

    <!-- Áé∞‰ª£ÂåñÂàÜÈ°µÂØºËà™ -->
    <div th:if="${!#lists.isEmpty(videos)}" class="pagination-container mt-5 mb-4">
        <div class="d-flex justify-content-between align-items-center">
            <!-- ÂàÜÈ°µ‰ø°ÊÅØ -->
            <div class="pagination-info">
                <span class="text-muted">
                    ÊòæÁ§∫Á¨¨ <strong th:text="${currentPage * size + 1}">1</strong> -
                    <strong th:text="${currentPage * size + #lists.size(videos)}">12</strong> Êù°Ôºå
                    ÂÖ± <strong th:text="${totalResults}">0</strong> Êù°ÁªìÊûú
                </span>
            </div>

            <!-- ÂàÜÈ°µÂØºËà™ -->
            <nav aria-label="‰∏ªÈ°µÂàÜÈ°µ">
                <ul class="pagination pagination-modern mb-0">
                    <!-- ‰∏ä‰∏ÄÈ°µ -->
                    <li class="page-item" th:classappend="${currentPage == 0 ? 'disabled' : ''}">
                        <a class="page-link page-prev"
                           th:href="${currentPage > 0 ? '?page=' + (currentPage - 1) + '&size=' + size + (currentCategory != null ? '&category=' + currentCategory : '') + (currentSort != null ? '&sort=' + currentSort : '') : '#'}"
                           aria-label="‰∏ä‰∏ÄÈ°µ">
                            <i class="fas fa-chevron-left"></i>
                            <span class="d-none d-sm-inline ms-1">‰∏ä‰∏ÄÈ°µ</span>
                        </a>
                    </li>

                    <!-- È°µÁ†Å -->
                    <th:block th:each="pageNum : ${#numbers.sequence(startPage, endPage)}">
                        <li class="page-item" th:classappend="${pageNum == currentPage ? 'active' : ''}">
                            <a class="page-link"
                               th:href="'?page=' + ${pageNum} + '&size=' + ${size} + ${currentCategory != null ? '&category=' + currentCategory : ''} + ${currentSort != null ? '&sort=' + currentSort : ''}"
                               th:text="${pageNum + 1}">1</a>
                        </li>
                    </th:block>

                    <!-- ÁúÅÁï•Âè∑ -->
                    <li class="page-item disabled" th:if="${endPage < totalPages - 1}">
                        <span class="page-link">...</span>
                    </li>

                    <!-- ÊúÄÂêé‰∏ÄÈ°µ -->
                    <li class="page-item" th:if="${endPage < totalPages - 1}">
                        <a class="page-link"
                           th:href="'?page=' + ${totalPages - 1} + '&size=' + ${size} + ${currentCategory != null ? '&category=' + currentCategory : ''} + ${currentSort != null ? '&sort=' + currentSort : ''}"
                           th:text="${totalPages}">ÊúÄÂêé</a>
                    </li>

                    <!-- ‰∏ã‰∏ÄÈ°µ -->
                    <li class="page-item" th:classappend="${currentPage >= totalPages - 1 ? 'disabled' : ''}">
                        <a class="page-link page-next"
                           th:href="${currentPage < totalPages - 1 ? '?page=' + (currentPage + 1) + '&size=' + size + (currentCategory != null ? '&category=' + currentCategory : '') + (currentSort != null ? '&sort=' + currentSort : '') : '#'}"
                           aria-label="‰∏ã‰∏ÄÈ°µ">
                            <span class="d-none d-sm-inline me-1">‰∏ã‰∏ÄÈ°µ</span>
                            <i class="fas fa-chevron-right"></i>
                        </a>
                    </li>
                </ul>
            </nav>

            <!-- ÊØèÈ°µÊòæÁ§∫Êï∞ÈáèÈÄâÊã© -->
            <div class="page-size-selector">
                <select class="form-select form-select-sm" onchange="changePageSizeHome(this.value)" style="width: auto;">
                    <option th:value="12" th:selected="${size == 12}">12Êù°/È°µ</option>
                    <option th:value="24" th:selected="${size == 24}">24Êù°/È°µ</option>
                    <option th:value="48" th:selected="${size == 48}">48Êù°/È°µ</option>
                    <option th:value="96" th:selected="${size == 96}">96Êù°/È°µ</option>
                </select>
            </div>
        </div>
    </div>
</div>

<!-- ÊµÆÂä®Êìç‰ΩúÊåâÈíÆ -->
<div class="floating-action" sec:authorize="isAuthenticated()">
    <a href="/upload" class="btn gradient-btn rounded-circle" style="width: 60px; height: 60px; display: flex; align-items: center; justify-content: center;">
        <i class="fas fa-plus fa-lg"></i>
    </a>
</div>

<!-- È°µËÑö -->
<footer class="footer-modern">
    <div class="container">
        <div class="row g-4 align-items-start">
            <!-- ÂìÅÁâå‰ø°ÊÅØ -->
            <div class="col-lg-2 col-md-6">
                <div class="footer-brand">
                    <h5 class="fw-bold mb-3">
                        <i class="fas fa-video me-2 text-primary"></i>ËßÜÈ¢ëÁΩëÁ´ô
                    </h5>
                    <p class="footer-description">
                        ÂèëÁé∞Á≤æÂΩ©ËßÜÈ¢ëÔºåÂàÜ‰∫´ÁæéÂ•ΩÊó∂ÂÖâ„ÄÇÂú®ËøôÈáåÊâæÂà∞‰Ω†ÂñúÊ¨¢ÁöÑÂÜÖÂÆπÔºå‰∏é‰∏ñÁïåÂàÜ‰∫´‰Ω†ÁöÑÂàõÊÑè„ÄÇ
                    </p>
                    <div class="social-links">
                        <a href="https://github.com" target="_blank" class="social-link" title="GitHub"><i class="fab fa-github"></i></a>
                        <a href="https://www.bilibili.com" target="_blank" class="social-link" title="ÂìîÂì©ÂìîÂì©"><i class="fas fa-tv"></i></a>
                        <a href="https://y.qq.com" target="_blank" class="social-link" title="QQÈü≥‰πê"><i class="fas fa-music"></i></a>
                        <a href="https://www.xiaohongshu.com" target="_blank" class="social-link" title="Â∞èÁ∫¢‰π¶"><i class="fas fa-book-open"></i></a>
                    </div>
                </div>
            </div>

            <!-- Âø´ÈÄüÈìæÊé• -->
            <div class="col-lg-2 col-md-6">
                <div class="footer-section">
                    <h6 class="footer-title">Âø´ÈÄüÈìæÊé•</h6>
                    <ul class="footer-links">
                        <li><a href="/"><i class="fas fa-home me-2"></i>È¶ñÈ°µ</a></li>
                        <li><a href="/search"><i class="fas fa-search me-2"></i>ÊêúÁ¥¢</a></li>
                        <li><a href="/upload"><i class="fas fa-upload me-2"></i>‰∏ä‰º†</a></li>
                        <li><a href="/profile"><i class="fas fa-user me-2"></i>‰∏™‰∫∫‰∏≠ÂøÉ</a></li>
                    </ul>
                </div>
            </div>

            <!-- ËßÜÈ¢ëÂàÜÁ±ª -->
            <div class="col-lg-2 col-md-6">
                <div class="footer-section">
                    <h6 class="footer-title">ÁÉ≠Èó®ÂàÜÁ±ª</h6>
                    <ul class="footer-links" id="dynamic-categories">
                        <!-- Âä®ÊÄÅÂä†ËΩΩÁöÑÂàÜÁ±ªÂ∞ÜÂú®ËøôÈáåÊòæÁ§∫ -->
                        <li><a href="/search?category=tech"><i class="fas fa-laptop-code me-2"></i>ÁßëÊäÄ</a></li>
                        <li><a href="/search?category=entertainment"><i class="fas fa-smile me-2"></i>Â®±‰πê</a></li>
                        <li><a href="/search?category=education"><i class="fas fa-graduation-cap me-2"></i>ÊïôËÇ≤</a></li>
                        <li><a href="/search?category=music"><i class="fas fa-music me-2"></i>Èü≥‰πê</a></li>
                    </ul>
                </div>
            </div>

            <!-- Â∏ÆÂä©ÊîØÊåÅ -->
            <div class="col-lg-2 col-md-6">
                <div class="footer-section">
                    <h6 class="footer-title">Â∏ÆÂä©ÊîØÊåÅ</h6>
                    <ul class="footer-links">
                        <li><a href="/help"><i class="fas fa-question-circle me-2"></i>Â∏ÆÂä©‰∏≠ÂøÉ</a></li>
                        <li><a href="#" onclick="showPrivacyPolicy()"><i class="fas fa-shield-alt me-2"></i>ÈöêÁßÅÊîøÁ≠ñ</a></li>
                        <li><a href="#" onclick="showTermsOfService()"><i class="fas fa-file-contract me-2"></i>ÊúçÂä°Êù°Ê¨æ</a></li>
                        <li><a href="#" onclick="showContactInfo()"><i class="fas fa-envelope me-2"></i>ËÅîÁ≥ªÊàë‰ª¨</a></li>
                    </ul>
                </div>
            </div>

            <!-- ÂÖ≥‰∫éÊàë‰ª¨ -->
            <div class="col-lg-2 col-md-6">
                <div class="footer-section">
                    <h6 class="footer-title">ÂÖ≥‰∫éÊàë‰ª¨</h6>
                    <ul class="footer-links">
                        <li><a href="/about"><i class="fas fa-info-circle me-2"></i>ÂÖ¨Âè∏‰ªãÁªç</a></li>
                        <li><a href="/team"><i class="fas fa-users me-2"></i>Âõ¢Èòü‰ªãÁªç</a></li>
                        <li><a href="/careers"><i class="fas fa-briefcase me-2"></i>ÊãõËÅò‰ø°ÊÅØ</a></li>
                        <li><a href="/news"><i class="fas fa-newspaper me-2"></i>Êñ∞ÈóªÂä®ÊÄÅ</a></li>
                    </ul>
                </div>
            </div>

            <!-- ÁªüËÆ°‰ø°ÊÅØ -->
            <div class="col-lg-2 col-md-6">
                <div class="footer-section">
                    <h6 class="footer-title">ÁΩëÁ´ôÁªüËÆ°</h6>
                    <div class="footer-stats" id="dynamic-stats">
                        <div class="stat-item">
                            <i class="fas fa-video text-primary"></i>
                            <div>
                                <div class="stat-number" id="stat-videos">1,234</div>
                                <div class="stat-label">ËßÜÈ¢ëÊÄªÊï∞</div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-users text-success"></i>
                            <div>
                                <div class="stat-number" id="stat-users">5,678</div>
                                <div class="stat-label">Ê≥®ÂÜåÁî®Êà∑</div>
                            </div>
                        </div>
                        <div class="stat-item">
                            <i class="fas fa-eye text-info"></i>
                            <div>
                                <div class="stat-number" id="stat-views">98.7K</div>
                                <div class="stat-label">ÊÄªËßÇÁúãÈáè</div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <!-- Â∫ïÈÉ®ÁâàÊùÉ -->
        <div class="footer-bottom">
            <div class="row align-items-center">
                <div class="col-md-6">
                    <p class="copyright-text">
                        &copy; 2026 ËßÜÈ¢ëÁΩëÁ´ô. ‰øùÁïôÊâÄÊúâÊùÉÂà©.
                        <span class="text-primary">Made with ËêΩÈõ®‚ù§Ô∏è</span>
                    </p>
                </div>
                <div class="col-md-6 text-md-end">
                    <div class="footer-badges">
                        <span class="badge bg-success me-2">
                            <i class="fas fa-shield-alt me-1"></i>ÂÆâÂÖ®ËÆ§ËØÅ
                        </span>
                        <span class="badge bg-primary">
                            <i class="fas fa-award me-1"></i>‰ºòË¥®ÊúçÂä°
                        </span>
                    </div>
                </div>
            </div>
        </div>
    </div>
</footer>

<!-- ÈöêÁßÅÊîøÁ≠ñÊ®°ÊÄÅÊ°Ü -->
<div class="modal fade" id="privacyPolicyModal" tabindex="-1" aria-labelledby="privacyPolicyModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="privacyPolicyModalLabel">
                    <i class="fas fa-shield-alt me-2"></i>ÈöêÁßÅÊîøÁ≠ñ
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="privacy-content">
                    <h6>1. ‰ø°ÊÅØÊî∂ÈõÜ</h6>
                    <p>Êàë‰ª¨Êî∂ÈõÜÊÇ®Âú®‰ΩøÁî®Êàë‰ª¨ÊúçÂä°Êó∂Êèê‰æõÁöÑ‰ø°ÊÅØÔºåÂåÖÊã¨‰ΩÜ‰∏çÈôê‰∫éÔºö</p>
                    <ul>
                        <li>Ê≥®ÂÜå‰ø°ÊÅØÔºöÁî®Êà∑Âêç„ÄÅÈÇÆÁÆ±Âú∞ÂùÄ„ÄÅÂØÜÁ†Å</li>
                        <li>‰∏™‰∫∫ËµÑÊñôÔºöÂ§¥ÂÉè„ÄÅ‰∏™‰∫∫ÁÆÄ‰ªã„ÄÅÂÖ¥Ë∂£Áà±Â•Ω</li>
                        <li>‰ΩøÁî®Êï∞ÊçÆÔºöËßÇÁúãÂéÜÂè≤„ÄÅÊêúÁ¥¢ËÆ∞ÂΩï„ÄÅ‰∫íÂä®Ë°å‰∏∫</li>
                        <li>ËÆæÂ§á‰ø°ÊÅØÔºöIPÂú∞ÂùÄ„ÄÅÊµèËßàÂô®Á±ªÂûã„ÄÅÊìç‰ΩúÁ≥ªÁªü</li>
                    </ul>

                    <h6>2. ‰ø°ÊÅØ‰ΩøÁî®</h6>
                    <p>Êàë‰ª¨‰ΩøÁî®Êî∂ÈõÜÁöÑ‰ø°ÊÅØÁî®‰∫éÔºö</p>
                    <ul>
                        <li>Êèê‰æõÂíåÊîπËøõÊàë‰ª¨ÁöÑÊúçÂä°</li>
                        <li>‰∏™ÊÄßÂåñÂÜÖÂÆπÊé®Ëçê</li>
                        <li>Áî®Êà∑Ë∫´‰ªΩÈ™åËØÅÂíåË¥¶Êà∑ÂÆâÂÖ®</li>
                        <li>ÂÆ¢Êà∑ÊîØÊåÅÂíåÊäÄÊúØÁª¥Êä§</li>
                        <li>Ê≥ïÂæãÂêàËßÑÂíåÂÆâÂÖ®‰øùÊä§</li>
                    </ul>

                    <h6>3. ‰ø°ÊÅØÂÖ±‰∫´</h6>
                    <p>Êàë‰ª¨‰∏ç‰ºöÂêëÁ¨¨‰∏âÊñπÂá∫ÂîÆ„ÄÅ‰∫§ÊòìÊàñËΩ¨ËÆ©ÊÇ®ÁöÑ‰∏™‰∫∫‰ø°ÊÅØÔºåÈô§ÈùûÔºö</p>
                    <ul>
                        <li>Ëé∑ÂæóÊÇ®ÁöÑÊòéÁ°ÆÂêåÊÑè</li>
                        <li>Ê≥ïÂæãÊ≥ïËßÑË¶ÅÊ±Ç</li>
                        <li>‰øùÊä§Êàë‰ª¨ÁöÑÊùÉÂà©ÂíåÂÆâÂÖ®</li>
                        <li>‰∏éÂèØ‰ø°ÁöÑÊúçÂä°Êèê‰æõÂïÜÂêà‰ΩúÔºàÂú®‰∏•Ê†ºÁöÑ‰øùÂØÜÂçèËÆÆ‰∏ãÔºâ</li>
                    </ul>

                    <h6>4. Êï∞ÊçÆÂÆâÂÖ®</h6>
                    <p>Êàë‰ª¨ÈááÁî®Ë°å‰∏öÊ†áÂáÜÁöÑÂÆâÂÖ®Êé™ÊñΩ‰øùÊä§ÊÇ®ÁöÑ‰ø°ÊÅØÔºö</p>
                    <ul>
                        <li>Êï∞ÊçÆÂä†ÂØÜ‰º†ËæìÂíåÂ≠òÂÇ®</li>
                        <li>ËÆøÈóÆÊéßÂà∂ÂíåÊùÉÈôêÁÆ°ÁêÜ</li>
                        <li>ÂÆöÊúüÂÆâÂÖ®ÂÆ°ËÆ°ÂíåÊºèÊ¥û‰øÆÂ§ç</li>
                        <li>ÂëòÂ∑•ÈöêÁßÅÂüπËÆ≠Âíå‰øùÂØÜÂçèËÆÆ</li>
                    </ul>

                    <h6>5. ÊÇ®ÁöÑÊùÉÂà©</h6>
                    <p>ÊÇ®ÊúâÊùÉÔºö</p>
                    <ul>
                        <li>ËÆøÈóÆÂíåÊõ¥Êñ∞ÊÇ®ÁöÑ‰∏™‰∫∫‰ø°ÊÅØ</li>
                        <li>Âà†Èô§ÊÇ®ÁöÑË¥¶Êà∑ÂíåÁõ∏ÂÖ≥Êï∞ÊçÆ</li>
                        <li>ÊéßÂà∂‰ø°ÊÅØÁöÑ‰ΩøÁî®ÂíåÂÖ±‰∫´</li>
                        <li>ÈÄâÊã©ÈÄÄÂá∫Êüê‰∫õÊï∞ÊçÆÊî∂ÈõÜ</li>
                    </ul>

                    <h6>6. Cookie‰ΩøÁî®</h6>
                    <p>Êàë‰ª¨‰ΩøÁî®CookieÂíåÁ±ª‰ººÊäÄÊúØÊù•ÊîπÂñÑÁî®Êà∑‰ΩìÈ™åÔºåÂåÖÊã¨ËÆ∞‰ΩèÁôªÂΩïÁä∂ÊÄÅ„ÄÅ‰∏™ÊÄßÂåñËÆæÁΩÆÂíåÂàÜÊûêÁΩëÁ´ô‰ΩøÁî®ÊÉÖÂÜµ„ÄÇÊÇ®ÂèØ‰ª•ÈÄöËøáÊµèËßàÂô®ËÆæÁΩÆÁÆ°ÁêÜCookieÂÅèÂ•Ω„ÄÇ</p>

                    <h6>7. ÊîøÁ≠ñÊõ¥Êñ∞</h6>
                    <p>Êàë‰ª¨ÂèØËÉΩ‰ºö‰∏çÊó∂Êõ¥Êñ∞Ê≠§ÈöêÁßÅÊîøÁ≠ñ„ÄÇÈáçÂ§ßÂèòÊõ¥Â∞ÜÈÄöËøáÁΩëÁ´ôÈÄöÁü•ÊàñÈÇÆ‰ª∂ÂΩ¢ÂºèÂëäÁü•Áî®Êà∑„ÄÇÁªßÁª≠‰ΩøÁî®Êàë‰ª¨ÁöÑÊúçÂä°Âç≥Ë°®Á§∫ÊÇ®ÂêåÊÑèÊõ¥Êñ∞ÂêéÁöÑÊîøÁ≠ñ„ÄÇ</p>

                    <h6>8. ËÅîÁ≥ªÊàë‰ª¨</h6>
                    <p>Â¶ÇÊûúÊÇ®ÂØπÊ≠§ÈöêÁßÅÊîøÁ≠ñÊúâ‰ªª‰ΩïÁñëÈóÆÔºåËØ∑ÈÄöËøá‰ª•‰∏ãÊñπÂºèËÅîÁ≥ªÊàë‰ª¨Ôºö</p>
                    <ul>
                        <li>ÈÇÆÁÆ±Ôºöprivacy@videosite.com</li>
                        <li>ÁîµËØùÔºö400-123-4567</li>
                        <li>Âú∞ÂùÄÔºöÂåó‰∫¨Â∏ÇÊúùÈò≥Âå∫ÁßëÊäÄÂõ≠Âå∫123Âè∑</li>
                    </ul>

                    <p class="text-muted mt-4"><small>ÊúÄÂêéÊõ¥Êñ∞Êó∂Èó¥Ôºö2026Âπ¥1Êúà1Êó•</small></p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂÖ≥Èó≠</button>
                <button type="button" class="btn btn-primary" onclick="acceptPrivacyPolicy()">ÊàëÂ∑≤ÈòÖËØªÂπ∂ÂêåÊÑè</button>
            </div>
        </div>
    </div>
</div>

<!-- ËÅîÁ≥ªÊàë‰ª¨Ê®°ÊÄÅÊ°Ü -->
<div class="modal fade" id="contactModal" tabindex="-1" aria-labelledby="contactModalLabel" aria-hidden="true">
    <div class="modal-dialog">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="contactModalLabel">
                    <i class="fas fa-envelope me-2"></i>ËÅîÁ≥ªÊàë‰ª¨
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="contact-info">
                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="contact-item">
                                <h6><i class="fas fa-envelope text-primary me-2"></i>ÈÇÆÁÆ±ÊîØÊåÅ</h6>
                                <p class="mb-1">support@videosite.com</p>
                                <small class="text-muted">Â∑•‰ΩúÊó∂Èó¥ÔºöÂë®‰∏ÄËá≥Âë®‰∫î 9:00-18:00</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="contact-item">
                                <h6><i class="fas fa-phone text-success me-2"></i>ÁîµËØùÊîØÊåÅ</h6>
                                <p class="mb-1">400-123-4567</p>
                                <small class="text-muted">7x24Â∞èÊó∂Âú®Á∫øÊúçÂä°</small>
                            </div>
                        </div>
                    </div>

                    <div class="row">
                        <div class="col-md-6 mb-3">
                            <div class="contact-item">
                                <h6><i class="fas fa-map-marker-alt text-info me-2"></i>ÂÖ¨Âè∏Âú∞ÂùÄ</h6>
                                <p class="mb-1">Âåó‰∫¨Â∏ÇÊúùÈò≥Âå∫ÁßëÊäÄÂõ≠Âå∫123Âè∑</p>
                                <small class="text-muted">ÈÇÆÁºñÔºö100000</small>
                            </div>
                        </div>
                        <div class="col-md-6 mb-3">
                            <div class="contact-item">
                                <h6><i class="fas fa-clock text-warning me-2"></i>Â∑•‰ΩúÊó∂Èó¥</h6>
                                <p class="mb-1">Âë®‰∏ÄËá≥Âë®‰∫îÔºö9:00-18:00</p>
                                <small class="text-muted">Âë®Êú´ÂèäËäÇÂÅáÊó•Ôºö10:00-16:00</small>
                            </div>
                        </div>
                    </div>

                    <hr>

                    <div class="social-contact">
                        <h6><i class="fas fa-share-alt text-primary me-2"></i>Á§æ‰∫§Â™í‰Ωì</h6>
                        <div class="d-flex gap-3">
                            <a href="https://github.com" target="_blank" class="btn btn-outline-dark btn-sm">
                                <i class="fab fa-github me-1"></i>GitHub
                            </a>
                            <a href="https://www.bilibili.com" target="_blank" class="btn btn-outline-primary btn-sm">
                                <i class="fas fa-tv me-1"></i>ÂìîÂì©ÂìîÂì©
                            </a>
                            <a href="https://y.qq.com" target="_blank" class="btn btn-outline-success btn-sm">
                                <i class="fas fa-music me-1"></i>QQÈü≥‰πê
                            </a>
                            <a href="https://www.xiaohongshu.com" target="_blank" class="btn btn-outline-danger btn-sm">
                                <i class="fas fa-book-open me-1"></i>Â∞èÁ∫¢‰π¶
                            </a>
                        </div>
                    </div>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂÖ≥Èó≠</button>
                <a href="/help" class="btn btn-primary">ËÆøÈóÆÂ∏ÆÂä©‰∏≠ÂøÉ</a>
            </div>
        </div>
    </div>
</div>

<!-- ÊúçÂä°Êù°Ê¨æÊ®°ÊÄÅÊ°Ü -->
<div class="modal fade" id="termsModal" tabindex="-1" aria-labelledby="termsModalLabel" aria-hidden="true">
    <div class="modal-dialog modal-lg modal-dialog-scrollable">
        <div class="modal-content">
            <div class="modal-header">
                <h5 class="modal-title" id="termsModalLabel">
                    <i class="fas fa-file-contract me-2"></i>ÊúçÂä°Êù°Ê¨æ
                </h5>
                <button type="button" class="btn-close" data-bs-dismiss="modal" aria-label="Close"></button>
            </div>
            <div class="modal-body">
                <div class="terms-content">
                    <h6>1. ÊúçÂä°ËØ¥Êòé</h6>
                    <p>Êú¨ÁΩëÁ´ôÊòØ‰∏Ä‰∏™ËßÜÈ¢ëÂàÜ‰∫´Âπ≥Âè∞Ôºå‰∏∫Áî®Êà∑Êèê‰æõËßÜÈ¢ë‰∏ä‰º†„ÄÅËßÇÁúã„ÄÅÂàÜ‰∫´Âíå‰∫íÂä®ÊúçÂä°„ÄÇ‰ΩøÁî®Êú¨ÊúçÂä°Âç≥Ë°®Á§∫ÊÇ®ÂêåÊÑèÈÅµÂÆà‰ª•‰∏ãÊù°Ê¨æ„ÄÇ</p>

                    <h6>2. Áî®Êà∑Ë¥£‰ªª</h6>
                    <p>Áî®Êà∑Âú®‰ΩøÁî®Êú¨ÊúçÂä°Êó∂Â∫îÂΩìÔºö</p>
                    <ul>
                        <li>Êèê‰æõÁúüÂÆû„ÄÅÂáÜÁ°ÆÁöÑÊ≥®ÂÜå‰ø°ÊÅØ</li>
                        <li>‰øùÊä§Ë¥¶Êà∑ÂÆâÂÖ®Ôºå‰∏ç‰∏é‰ªñ‰∫∫ÂÖ±‰∫´ÁôªÂΩï‰ø°ÊÅØ</li>
                        <li>ÈÅµÂÆàÁõ∏ÂÖ≥Ê≥ïÂæãÊ≥ïËßÑÂíåÁ§æÂå∫ËßÑËåÉ</li>
                        <li>‰∏ç‰∏ä‰º†ËøùÊ≥ï„ÄÅÊúâÂÆ≥Êàñ‰æµÊùÉÂÜÖÂÆπ</li>
                        <li>Â∞äÈáçÂÖ∂‰ªñÁî®Êà∑ÁöÑÊùÉÂà©ÂíåÈöêÁßÅ</li>
                    </ul>

                    <h6>3. ÂÜÖÂÆπËßÑËåÉ</h6>
                    <p>Á¶ÅÊ≠¢‰∏ä‰º†‰ª•‰∏ãÁ±ªÂûãÁöÑÂÜÖÂÆπÔºö</p>
                    <ul>
                        <li>ËøùÂèçÊ≥ïÂæãÊ≥ïËßÑÁöÑÂÜÖÂÆπ</li>
                        <li>‰æµÁäØ‰ªñ‰∫∫Áü•ËØÜ‰∫ßÊùÉÁöÑÂÜÖÂÆπ</li>
                        <li>ÂåÖÂê´Êö¥Âäõ„ÄÅËâ≤ÊÉÖ„ÄÅÊÅêÊÄñ‰∏ª‰πâÁöÑÂÜÖÂÆπ</li>
                        <li>ËôöÂÅá‰ø°ÊÅØÊàñËØØÂØºÊÄßÂÜÖÂÆπ</li>
                        <li>ÂûÉÂúæ‰ø°ÊÅØÊàñÊÅ∂ÊÑèËΩØ‰ª∂</li>
                    </ul>

                    <h6>4. Áü•ËØÜ‰∫ßÊùÉ</h6>
                    <p>Áî®Êà∑‰∏ä‰º†ÁöÑÂÜÖÂÆπÂ∫îÁ°Æ‰øùÊã•ÊúâÁõ∏Â∫îÁöÑÊùÉÂà©„ÄÇÁî®Êà∑Êéà‰∫àÊú¨Âπ≥Âè∞Âú®ÂÖ®ÁêÉËåÉÂõ¥ÂÜÖ‰ΩøÁî®„ÄÅÂ±ïÁ§∫„ÄÅ‰º†Êí≠ÂÖ∂‰∏ä‰º†ÂÜÖÂÆπÁöÑÊùÉÂà©„ÄÇ</p>

                    <h6>5. ÊúçÂä°ÂèòÊõ¥</h6>
                    <p>Êàë‰ª¨‰øùÁïôÈöèÊó∂‰øÆÊîπ„ÄÅÊöÇÂÅúÊàñÁªàÊ≠¢ÊúçÂä°ÁöÑÊùÉÂà©„ÄÇÈáçÂ§ßÂèòÊõ¥Â∞ÜÊèêÂâçÈÄöÁü•Áî®Êà∑„ÄÇ</p>

                    <h6>6. ÂÖçË¥£Â£∞Êòé</h6>
                    <p>Êú¨Âπ≥Âè∞‰∏çÂØπÁî®Êà∑‰∏ä‰º†ÁöÑÂÜÖÂÆπÊâøÊãÖË¥£‰ªªÔºå‰∏ç‰øùËØÅÊúçÂä°ÁöÑËøûÁª≠ÊÄßÂíåÂÆåÊï¥ÊÄß„ÄÇÁî®Êà∑‰ΩøÁî®ÊúçÂä°ÁöÑÈ£éÈô©Áî±ÂÖ∂Ëá™Ë°åÊâøÊãÖ„ÄÇ</p>

                    <h6>7. ‰∫âËÆÆËß£ÂÜ≥</h6>
                    <p>Âõ†‰ΩøÁî®Êú¨ÊúçÂä°‰∫ßÁîüÁöÑ‰∫âËÆÆÔºåÂ∫îÈ¶ñÂÖàÈÄöËøáÂèãÂ•ΩÂçèÂïÜËß£ÂÜ≥„ÄÇÂçèÂïÜ‰∏çÊàêÁöÑÔºåÊèê‰∫§Ëá≥Êú¨ÂÖ¨Âè∏ÊâÄÂú®Âú∞‰∫∫Ê∞ëÊ≥ïÈô¢Ëß£ÂÜ≥„ÄÇ</p>

                    <p class="text-muted mt-4"><small>ÊúÄÂêéÊõ¥Êñ∞Êó∂Èó¥Ôºö2024Âπ¥1Êúà1Êó•</small></p>
                </div>
            </div>
            <div class="modal-footer">
                <button type="button" class="btn btn-secondary" data-bs-dismiss="modal">ÂÖ≥Èó≠</button>
                <button type="button" class="btn btn-primary" onclick="acceptTerms()">ÊàëÂ∑≤ÈòÖËØªÂπ∂ÂêåÊÑè</button>
            </div>
        </div>
    </div>
</div>

<!-- JavaScript files -->
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
<!-- WebSocketÁõ∏ÂÖ≥Â∫ì -->
<script src="/lib/sockjs.min.js"></script>
<script src="/lib/stomp.min.js"></script>
<!-- ÂÖ®Â±ÄÊù•ÁîµÂºπÁ™ó -->
<script src="/js/global-call-popup.js"></script>
<!-- WebRTCÂÆ¢Êà∑Á´Ø -->
<script src="/js/webrtc-client.js"></script>
<!-- ÂÖ®Â±ÄWebRTCÁÆ°ÁêÜÂô® -->
<script src="/js/global-webrtc-manager.js"></script>
<!-- Âú®Á∫øÁä∂ÊÄÅÁÆ°ÁêÜ -->
<script src="/js/online-status.js"></script>
<!-- ÈîôËØØÁõëÊéßÊöÇÊó∂Á¶ÅÁî® -->
<!-- <script src="/js/error-monitor.js"></script> -->
<!-- Êô∫ËÉΩÂä©ÊâãÂäüËÉΩÂ∑≤Á¶ÅÁî® -->
<!-- <script src="/js/pet-themes.js"></script> -->
<!-- <script src="/js/smart-pet.js"></script> -->
<!-- <script src="/js/ai-assistant.js"></script> -->
<script>
    // ËÆæÁΩÆÂÖ®Â±ÄÁî®Êà∑‰ø°ÊÅØ
    window.currentUser = /*[[${currentUser}]]*/ null;
    window.isAuthenticated = /*[[${isAuthenticated}]]*/ false;

    // Â¶ÇÊûúÁî®Êà∑Â∑≤ÁôªÂΩïÔºåËÆæÁΩÆÁî®Êà∑‰ø°ÊÅØ
    if (window.currentUser) {
        console.log('‚úÖ Áî®Êà∑Â∑≤ÁôªÂΩï:', window.currentUser.username);
    } else {
        console.log('‚ÑπÔ∏è Áî®Êà∑Êú™ÁôªÂΩï');
    }

    // ÂàùÂßãÂåñWebRTCÂÆ¢Êà∑Á´ØÔºàÂ¶ÇÊûúÁî®Êà∑Â∑≤ÁôªÂΩïÔºâ
    document.addEventListener('DOMContentLoaded', function() {
        // ÈÄöËøáAPIËé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂπ∂ÂàùÂßãÂåñWebRTC
        initializeWebRTCForHomePageWithAPI();
    });

    // ÈÄöËøáAPIËé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂπ∂ÂàùÂßãÂåñWebRTC
    async function initializeWebRTCForHomePageWithAPI() {
        try {
            const response = await fetch('/api/chat/user', {
                method: 'GET',
                credentials: 'same-origin',
                headers: {
                    'X-Requested-With': 'XMLHttpRequest'
                }
            });

            if (response.ok) {
                const userData = await response.json();
                const userId = userData.id.toString();
                console.log('‰∏ªÈ°µËé∑ÂèñÁî®Êà∑‰ø°ÊÅØÊàêÂäü:', userData);
                initializeWebRTCForHomePage(userId);
            } else {
                console.log('‰∏ªÈ°µÁî®Êà∑Êú™ÁôªÂΩïÔºåË∑≥ËøáWebRTCÂàùÂßãÂåñ');
            }
        } catch (error) {
            console.warn('‰∏ªÈ°µËé∑ÂèñÁî®Êà∑‰ø°ÊÅØÂ§±Ë¥•:', error);
        }
    }

    // ‰∏∫‰∏ªÈ°µÂàùÂßãÂåñWebRTC
    async function initializeWebRTCForHomePage(userId) {
        try {
            // Ê£ÄÊü•ÂøÖË¶ÅÁöÑÂ∫ìÊòØÂê¶Âä†ËΩΩ
            if (typeof SockJS === 'undefined' || typeof Stomp === 'undefined') {
                console.warn('WebSocketÂ∫ìÊú™Âä†ËΩΩÔºåË∑≥ËøáWebRTCÂàùÂßãÂåñ');
                return;
            }

            if (typeof GlobalWebRTCManager === 'undefined') {
                console.warn('GlobalWebRTCManagerÊú™Âä†ËΩΩÔºåË∑≥ËøáWebRTCÂàùÂßãÂåñ');
                return;
            }

            if (!userId) {
                console.warn('Áî®Êà∑ID‰∏∫Á©∫ÔºåË∑≥ËøáWebRTCÂàùÂßãÂåñ');
                return;
            }

            // ÂàõÂª∫ÂÖ®Â±ÄWebRTCÁÆ°ÁêÜÂô®ÂÆû‰æã
            if (!window.globalWebRTCManager) {
                window.globalWebRTCManager = new GlobalWebRTCManager('home');
                console.log('‰∏ªÈ°µÂÖ®Â±ÄWebRTCÁÆ°ÁêÜÂô®Â∑≤ÂàõÂª∫');

                // ÂàùÂßãÂåñÁÆ°ÁêÜÂô®
                await window.globalWebRTCManager.initialize();
                console.log('‰∏ªÈ°µÂÖ®Â±ÄWebRTCÁÆ°ÁêÜÂô®ÂàùÂßãÂåñÊàêÂäü');
            }
        } catch (error) {
            console.error('‰∏ªÈ°µWebRTCÂàùÂßãÂåñÂ§±Ë¥•:', error);
        }
    }

    // Âä†ËΩΩÁΩëÁ´ôÁªüËÆ°Êï∞ÊçÆ
    function loadWebsiteStatistics() {
        fetch('/api/statistics/basic', {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            },
            credentials: 'same-origin'
        })
        .then(response => response.json())
        .then(data => {
            // Êõ¥Êñ∞ÁªüËÆ°Êï∞Â≠ó
            const statVideos = document.getElementById('stat-videos');
            const statUsers = document.getElementById('stat-users');
            const statViews = document.getElementById('stat-views');

            if (statVideos) statVideos.textContent = data.totalVideos || '1,234';
            if (statUsers) statUsers.textContent = data.totalUsers || '5,678';
            if (statViews) statViews.textContent = data.totalViews || '98.7K';
        })
        .catch(error => {
            console.error('Ëé∑ÂèñÁΩëÁ´ôÁªüËÆ°Êï∞ÊçÆÂ§±Ë¥•:', error);
        });
    }

    // Âä†ËΩΩÂä®ÊÄÅÂàÜÁ±ª
    function loadDynamicCategories() {
        fetch('/api/categories/popular?limit=4', {
            method: 'GET',
            headers: {
                'X-Requested-With': 'XMLHttpRequest'
            },
            credentials: 'same-origin'
        })
        .then(response => response.json())
        .then(data => {
            const categoriesContainer = document.getElementById('dynamic-categories');
            if (categoriesContainer && data.length > 0) {
                let html = '';
                data.forEach(category => {
                    const categoryName = category.name;
                    const categoryIcon = category.icon || 'fas fa-video';
                    const categoryId = category.id > 0 ? category.id : categoryName.toLowerCase();

                    html += `
                        <li>
                            <a href="/search?category=${categoryId}" title="${category.description || categoryName}">
                                <i class="${categoryIcon} me-2"></i>${categoryName}
                            </a>
                        </li>
                    `;
                });
                categoriesContainer.innerHTML = html;
            }
        })
        .catch(error => {
            console.error('Ëé∑ÂèñÂä®ÊÄÅÂàÜÁ±ªÂ§±Ë¥•:', error);
        });
    }

    // Ê∑ªÂä†‰∏Ä‰∫õ‰∫§‰∫íÊïàÊûú
    document.addEventListener('DOMContentLoaded', function() {


        // Âä†ËΩΩÁΩëÁ´ôÁªüËÆ°Êï∞ÊçÆÂíåÂä®ÊÄÅÂàÜÁ±ª
        loadWebsiteStatistics();
        loadDynamicCategories();

        // ÂàÜÁ±ªÂç°ÁâáÁÇπÂáªÊïàÊûú
        document.querySelectorAll('.category-card').forEach(card => {
            card.addEventListener('click', function() {
                console.log('ÁÇπÂáª‰∫ÜÂàÜÁ±ª:', this.querySelector('h5').textContent);
            });
        });

        // ÊêúÁ¥¢Ê°ÜÁÑ¶ÁÇπÊïàÊûú
        const searchInput = document.querySelector('.search-box input');
        if (searchInput) {
            searchInput.addEventListener('focus', function() {
                this.parentElement.parentElement.style.transform = 'scale(1.02)';
                this.parentElement.parentElement.style.transition = 'all 0.3s ease';
            });

            searchInput.addEventListener('blur', function() {
                this.parentElement.parentElement.style.transform = 'scale(1)';
            });
        }

        // Ë∑≥ËΩ¨È°µÈù¢ÂäüËÉΩÂàùÂßãÂåñ
        const jumpInput = document.getElementById('jumpToPage');
        if (jumpInput) {
            jumpInput.addEventListener('keypress', function(e) {
                if (e.key === 'Enter') {
                    jumpToPage();
                }
            });
        }
    });

    // ÊéíÂ∫èÂäüËÉΩ
    function changeSortOrder() {
        const sortSelect = document.getElementById('sortSelect');
        const sortValue = sortSelect.value;
        const currentUrl = new URL(window.location);
        currentUrl.searchParams.set('sort', sortValue);
        currentUrl.searchParams.delete('page'); // ÈáçÁΩÆÂà∞Á¨¨‰∏ÄÈ°µ
        window.location.href = currentUrl.toString();
    }

    // ÂàÜÈ°µË∑≥ËΩ¨ÂäüËÉΩ
    function jumpToPage() {
        const jumpInput = document.getElementById('jumpToPage');
        const pageNumber = parseInt(jumpInput.value);
        const maxPages = parseInt(jumpInput.getAttribute('max'));

        if (pageNumber >= 1 && pageNumber <= maxPages) {
            const currentUrl = new URL(window.location);
            currentUrl.searchParams.set('page', pageNumber - 1); // ÂêéÁ´Ø‰ΩøÁî®0ÂºÄÂßãÁöÑÈ°µÁ†Å
            window.location.href = currentUrl.toString();
        } else {
            alert(`ËØ∑ËæìÂÖ•1Âà∞${maxPages}‰πãÈó¥ÁöÑÈ°µÁ†Å`);
            jumpInput.value = '';
        }
    }

    // ÂõûËΩ¶ÈîÆË∑≥ËΩ¨ÂäüËÉΩÂ∑≤ÁßªËá≥‰∏ªDOMContentLoaded‰∫ã‰ª∂‰∏≠

    // ÊêúÁ¥¢Âª∫ËÆÆÂäüËÉΩ
    let searchTimeout;
    let currentSuggestionIndex = -1;
    let suggestions = [];

    const searchInput = document.getElementById('searchInput');
    const suggestionsDropdown = document.getElementById('searchSuggestions');

    if (searchInput && suggestionsDropdown) {
        // ËæìÂÖ•‰∫ã‰ª∂ÁõëÂê¨
        searchInput.addEventListener('input', function() {
            const query = this.value.trim();

            clearTimeout(searchTimeout);

            if (query.length < 2) {
                hideSuggestions();
                return;
            }

            searchTimeout = setTimeout(() => {
                fetchSearchSuggestions(query);
            }, 300);
        });

        // ÈîÆÁõòÂØºËà™
        searchInput.addEventListener('keydown', function(e) {
            if (suggestions.length === 0) return;

            switch(e.key) {
                case 'ArrowDown':
                    e.preventDefault();
                    currentSuggestionIndex = Math.min(currentSuggestionIndex + 1, suggestions.length - 1);
                    updateSuggestionSelection();
                    break;
                case 'ArrowUp':
                    e.preventDefault();
                    currentSuggestionIndex = Math.max(currentSuggestionIndex - 1, -1);
                    updateSuggestionSelection();
                    break;
                case 'Enter':
                    if (currentSuggestionIndex >= 0) {
                        e.preventDefault();
                        selectSuggestion(suggestions[currentSuggestionIndex]);
                    }
                    break;
                case 'Escape':
                    hideSuggestions();
                    break;
            }
        });

        // Â§±ÂéªÁÑ¶ÁÇπÊó∂ÈöêËóèÂª∫ËÆÆ
        searchInput.addEventListener('blur', function() {
            setTimeout(() => {
                hideSuggestions();
            }, 200);
        });
    }

    // Ëé∑ÂèñÊêúÁ¥¢Âª∫ËÆÆ
    function fetchSearchSuggestions(query) {
        fetch(`/api/search/suggestions-enhanced?q=${encodeURIComponent(query)}&limit=8`)
            .then(response => response.json())
            .then(data => {
                if (data.success && data.suggestions) {
                    suggestions = data.suggestions;
                    displaySuggestions(suggestions);
                }
            })
            .catch(error => {
                console.error('Ëé∑ÂèñÊêúÁ¥¢Âª∫ËÆÆÂ§±Ë¥•:', error);
            });
    }

    // ÊòæÁ§∫ÊêúÁ¥¢Âª∫ËÆÆ
    function displaySuggestions(suggestionList) {
        if (suggestionList.length === 0) {
            hideSuggestions();
            return;
        }

        let html = '';
        suggestionList.forEach((suggestion, index) => {
            html += `
                <div class="search-suggestion-item" data-index="${index}" onclick="selectSuggestion('${suggestion}')">
                    <i class="fas fa-search search-suggestion-icon"></i>
                    <span class="search-suggestion-text">${suggestion}</span>
                </div>
            `;
        });

        suggestionsDropdown.innerHTML = html;
        suggestionsDropdown.style.display = 'block';
        currentSuggestionIndex = -1;
    }

    // ÈöêËóèÊêúÁ¥¢Âª∫ËÆÆ
    function hideSuggestions() {
        suggestionsDropdown.style.display = 'none';
        currentSuggestionIndex = -1;
        suggestions = [];
    }

    // Êõ¥Êñ∞Âª∫ËÆÆÈÄâÊã©Áä∂ÊÄÅ
    function updateSuggestionSelection() {
        const items = suggestionsDropdown.querySelectorAll('.search-suggestion-item');
        items.forEach((item, index) => {
            if (index === currentSuggestionIndex) {
                item.classList.add('active');
                searchInput.value = suggestions[index];
            } else {
                item.classList.remove('active');
            }
        });
    }

    // ÈÄâÊã©Âª∫ËÆÆ
    function selectSuggestion(suggestion) {
        searchInput.value = suggestion;
        hideSuggestions();
        // Ëá™Âä®Êèê‰∫§ÊêúÁ¥¢
        searchInput.closest('form').submit();
    }

    // ÊòæÁ§∫ÈöêÁßÅÊîøÁ≠ñ
    function showPrivacyPolicy() {
        const modal = new bootstrap.Modal(document.getElementById('privacyPolicyModal'));
        modal.show();
    }

    // ÊòæÁ§∫ËÅîÁ≥ª‰ø°ÊÅØ
    function showContactInfo() {
        const modal = new bootstrap.Modal(document.getElementById('contactModal'));
        modal.show();
    }

    // ÊòæÁ§∫ÊúçÂä°Êù°Ê¨æ
    function showTermsOfService() {
        const modal = new bootstrap.Modal(document.getElementById('termsModal'));
        modal.show();
    }

    // Êé•ÂèóÈöêÁßÅÊîøÁ≠ñ
    function acceptPrivacyPolicy() {
        // ÂèØ‰ª•Âú®ËøôÈáåÊ∑ªÂä†ËÆ∞ÂΩïÁî®Êà∑ÂêåÊÑèÁöÑÈÄªËæë
        localStorage.setItem('privacyPolicyAccepted', 'true');
        const modal = bootstrap.Modal.getInstance(document.getElementById('privacyPolicyModal'));
        modal.hide();

        // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
        showNotification('ÊÑüË∞¢ÊÇ®ÈòÖËØªÂπ∂ÂêåÊÑèÊàë‰ª¨ÁöÑÈöêÁßÅÊîøÁ≠ñÔºÅ', 'success');
    }

    // Êé•ÂèóÊúçÂä°Êù°Ê¨æ
    function acceptTerms() {
        // ÂèØ‰ª•Âú®ËøôÈáåÊ∑ªÂä†ËÆ∞ÂΩïÁî®Êà∑ÂêåÊÑèÁöÑÈÄªËæë
        localStorage.setItem('termsAccepted', 'true');
        const modal = bootstrap.Modal.getInstance(document.getElementById('termsModal'));
        modal.hide();

        // ÊòæÁ§∫ÊàêÂäüÊèêÁ§∫
        showNotification('ÊÑüË∞¢ÊÇ®ÈòÖËØªÂπ∂ÂêåÊÑèÊàë‰ª¨ÁöÑÊúçÂä°Êù°Ê¨æÔºÅ', 'success');
    }

    // ÊòæÁ§∫ÈÄöÁü•
    function showNotification(message, type = 'info') {
        // ÂàõÂª∫ÈÄöÁü•ÂÖÉÁ¥†
        const notification = document.createElement('div');
        notification.className = `alert alert-${type} alert-dismissible fade show position-fixed`;
        notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
        notification.innerHTML = `
            ${message}
            <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
        `;

        document.body.appendChild(notification);

        // 3ÁßíÂêéËá™Âä®ÁßªÈô§
        setTimeout(() => {
            if (notification.parentNode) {
                notification.remove();
            }
        }, 3000);
    }

    // Á≠æÂà∞ÂäüËÉΩ
    function dailyCheckin() {
        const checkinBtn = document.getElementById('checkinBtn');
        const originalText = checkinBtn.innerHTML;

        // ÊòæÁ§∫Âä†ËΩΩÁä∂ÊÄÅ
        checkinBtn.innerHTML = '<i class="fas fa-spinner fa-spin me-1"></i>Á≠æÂà∞‰∏≠...';
        checkinBtn.disabled = true;

        fetch('/api/checkin', {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            }
        })
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                // Á≠æÂà∞ÊàêÂäü
                const message = `Á≠æÂà∞ÊàêÂäüÔºÅËé∑Âæó ${data.reward} ÁªèÈ™åÂÄº\nËøûÁª≠Á≠æÂà∞ ${data.consecutiveDays} Â§©ÔºåÊÄªËÆ°Á≠æÂà∞ ${data.totalDays} Â§©`;
                showNotification(message, 'success');
                checkinBtn.innerHTML = `<i class="fas fa-check me-1"></i>Â∑≤Á≠æÂà∞ (${data.totalDays}Â§©)`;
                checkinBtn.classList.remove('btn-outline-light');
                checkinBtn.classList.add('btn-success');

                // Êõ¥Êñ∞Áî®Êà∑Á≠âÁ∫ßÊòæÁ§∫
                if (data.currentLevel) {
                    const levelBadge = document.getElementById('userLevelBadge');
                    if (levelBadge) {
                        levelBadge.textContent = 'Lv.' + data.currentLevel;
                        levelBadge.style.display = 'inline';
                    }
                }
            } else {
                // Á≠æÂà∞Â§±Ë¥•
                if (data.alreadyCheckedIn) {
                    const message = `‰ªäÂ§©Â∑≤ÁªèÁ≠æÂà∞Ëøá‰∫Ü\nËøûÁª≠Á≠æÂà∞ ${data.consecutiveDays || 0} Â§©ÔºåÊÄªËÆ°Á≠æÂà∞ ${data.totalDays || 0} Â§©`;
                    showNotification(message, 'info');
                    checkinBtn.innerHTML = `<i class="fas fa-check me-1"></i>Â∑≤Á≠æÂà∞ (${data.totalDays || 0}Â§©)`;
                    checkinBtn.classList.remove('btn-outline-light');
                    checkinBtn.classList.add('btn-success');
                } else {
                    showNotification(data.message || 'Á≠æÂà∞Â§±Ë¥•', 'error');
                    // Âç≥‰ΩøÁ≠æÂà∞Â§±Ë¥•Ôºå‰πüË¶ÅÊõ¥Êñ∞ÊåâÈíÆÊòæÁ§∫ÂΩìÂâçÁ≠æÂà∞Áä∂ÊÄÅ
                    if (data.consecutiveDays !== undefined && data.totalDays !== undefined) {
                        if (data.totalDays > 0) {
                            checkinBtn.innerHTML = `<i class="fas fa-calendar-check me-1"></i>Á≠æÂà∞ (${data.totalDays}Â§©)`;
                        } else {
                            checkinBtn.innerHTML = originalText;
                        }
                    } else {
                        checkinBtn.innerHTML = originalText;
                    }
                }
            }
        })
        .catch(error => {
            console.error('Á≠æÂà∞Â§±Ë¥•:', error);
            showNotification('Á≠æÂà∞Â§±Ë¥•ÔºåËØ∑Á®çÂêéÈáçËØï', 'error');
            checkinBtn.innerHTML = originalText;
        })
        .finally(() => {
            checkinBtn.disabled = false;
        });
    }

    // È°µÈù¢Âä†ËΩΩÊó∂Ê£ÄÊü•Á≠æÂà∞Áä∂ÊÄÅ
    document.addEventListener('DOMContentLoaded', function() {
        // Ê£ÄÊü•Áî®Êà∑ÊòØÂê¶Â∑≤ÁôªÂΩï
        const userElement = document.querySelector('[data-current-user]');
        if (userElement && userElement.dataset.username) {
            checkCheckinStatus();
            checkUnreadMessages();
        }
    });

    function checkCheckinStatus() {
        fetch('/api/checkin/status')
        .then(response => response.json())
        .then(data => {
            if (data.success) {
                const checkinBtn = document.getElementById('checkinBtn');
                if (data.hasCheckedInToday) {
                    checkinBtn.innerHTML = `<i class="fas fa-check me-1"></i>Â∑≤Á≠æÂà∞ (${data.totalDays || 0}Â§©)`;
                    checkinBtn.classList.remove('btn-outline-light');
                    checkinBtn.classList.add('btn-success');
                    checkinBtn.disabled = true;
                } else {
                    // Â¶ÇÊûúËøòÊ≤°Á≠æÂà∞ÔºåÊòæÁ§∫ÊÄªÁ≠æÂà∞Â§©Êï∞
                    if (data.totalDays > 0) {
                        checkinBtn.innerHTML = `<i class="fas fa-calendar-check me-1"></i>Á≠æÂà∞ (${data.totalDays}Â§©)`;
                    }
                }

                // Êõ¥Êñ∞Áî®Êà∑Á≠âÁ∫ßÊòæÁ§∫
                if (data.currentLevel) {
                    const levelBadge = document.getElementById('userLevelBadge');
                    if (levelBadge) {
                        levelBadge.textContent = 'Lv.' + data.currentLevel;
                        levelBadge.style.display = 'inline';
                    }
                }
            }
        })
        .catch(error => {
            console.error('Ê£ÄÊü•Á≠æÂà∞Áä∂ÊÄÅÂ§±Ë¥•:', error);
        });
    }

    function checkUnreadMessages() {
        fetch('/api/chat/unread-count')
        .then(response => response.json())
        .then(data => {
            if (data.success && data.count > 0) {
                const chatBadge = document.getElementById('chatUnreadBadge');
                if (chatBadge) {
                    chatBadge.textContent = data.count > 99 ? '99+' : data.count;
                    chatBadge.style.display = 'inline';
                }
            }
        })
        .catch(error => {
            console.error('Ëé∑ÂèñÊú™ËØªÊ∂àÊÅØÊï∞ÈáèÂ§±Ë¥•:', error);
        });
    }

    // ÂÆöÊúüÊ£ÄÊü•Êú™ËØªÊ∂àÊÅØÊï∞Èáè
    setInterval(checkUnreadMessages, 30000); // ÊØè30ÁßíÊ£ÄÊü•‰∏ÄÊ¨°

    // ‰∏ªÈ°µÂàÜÈ°µÁõ∏ÂÖ≥ÂáΩÊï∞
    function changePageSizeHome(newSize) {
        const url = new URL(window.location);
        url.searchParams.set('size', newSize);
        url.searchParams.set('page', '0'); // ÈáçÁΩÆÂà∞Á¨¨‰∏ÄÈ°µ
        window.location.href = url.toString();
    }

    // Ë∑≥ËΩ¨Âà∞ÊåáÂÆöÈ°µÈù¢
    function goToPageHome(pageNum) {
        const url = new URL(window.location);
        url.searchParams.set('page', pageNum);
        window.location.href = url.toString();
    }

    // ÈîÆÁõòÂØºËà™ÊîØÊåÅ
    document.addEventListener('keydown', function(e) {
        if (e.ctrlKey || e.metaKey) {
            if (e.key === 'ArrowLeft') {
                // Ctrl + Â∑¶ÁÆ≠Â§¥Ôºö‰∏ä‰∏ÄÈ°µ
                const prevBtn = document.querySelector('.page-prev');
                if (prevBtn && !prevBtn.closest('.page-item').classList.contains('disabled')) {
                    e.preventDefault();
                    prevBtn.click();
                }
            } else if (e.key === 'ArrowRight') {
                // Ctrl + Âè≥ÁÆ≠Â§¥Ôºö‰∏ã‰∏ÄÈ°µ
                const nextBtn = document.querySelector('.page-next');
                if (nextBtn && !nextBtn.closest('.page-item').classList.contains('disabled')) {
                    e.preventDefault();
                    nextBtn.click();
                }
            }
        }
    });

    // ÂàùÂßãÂåñÂú®Á∫øÁä∂ÊÄÅÂäüËÉΩ
    document.addEventListener('DOMContentLoaded', function() {
        // Á≠âÂæÖÂú®Á∫øÁä∂ÊÄÅÁÆ°ÁêÜÂô®ÂàùÂßãÂåñÂÆåÊàê
        setTimeout(function() {
            if (window.onlineStatusManager) {
                // Ëé∑ÂèñÈ°µÈù¢‰∏äÊâÄÊúâÁî®Êà∑ID
                const userElements = document.querySelectorAll('[data-user-id]');
                const userIds = new Set();

                userElements.forEach(element => {
                    const userId = element.getAttribute('data-user-id');
                    if (userId && userId !== 'null') {
                        userIds.add(parseInt(userId));
                    }
                });

                // ÊâπÈáèÊ£ÄÊü•Áî®Êà∑Âú®Á∫øÁä∂ÊÄÅ
                if (userIds.size > 0) {
                    window.onlineStatusManager.checkUserStatus(userIds);
                }

                // Ëé∑ÂèñÂú®Á∫øÁî®Êà∑ÁªüËÆ°
                window.onlineStatusManager.getOnlineUsers();
            }
        }, 1000);

        // Êõ¥Êñ∞ËÅäÂ§©Êú™ËØªÊ∂àÊÅØËÆ°Êï∞
        updateChatUnreadCount();

        // ÂÆöÊúüÊõ¥Êñ∞ËÅäÂ§©Êú™ËØªÊ∂àÊÅØËÆ°Êï∞
        setInterval(updateChatUnreadCount, 30000); // 30ÁßíÊõ¥Êñ∞‰∏ÄÊ¨°
    });

    // Êõ¥Êñ∞ËÅäÂ§©Êú™ËØªÊ∂àÊÅØËÆ°Êï∞
    function updateChatUnreadCount() {
        fetch('/api/chat/unread-count')
            .then(response => response.json())
            .then(data => {
                const badge = document.getElementById('chatUnreadBadge');
                if (badge) {
                    const count = data.count || 0;
                    if (count > 0) {
                        badge.textContent = count > 99 ? '99+' : count;
                        badge.style.display = 'inline';
                    } else {
                        badge.style.display = 'none';
                    }
                }
            })
            .catch(error => {
                console.error('Êõ¥Êñ∞ËÅäÂ§©Êú™ËØªÊ∂àÊÅØËÆ°Êï∞Â§±Ë¥•:', error);
            });
    }

</script>

<!-- Áî®Êà∑Êï∞ÊçÆ -->
<div data-current-user
     data-current-user-id="[[${#authentication.principal.id}]]"
     data-current-username="[[${#authentication.name}]]"
     style="display: none;"></div>

<!-- ÂÖ®Â±ÄÈÄöÁü•ÁÆ°ÁêÜ - ÊöÇÊó∂Á¶ÅÁî®‰ª•ÈÅøÂÖçÂÜ≤Á™Å -->
<!-- <script src="/js/global-notifications.js"></script> -->

<!-- ÂÖ®Â±ÄÊô∫ËÉΩÂä©ÊâãÂäüËÉΩÂ∑≤Á¶ÅÁî® -->
<!-- <script src="/js/global-smart-pet.js"></script> -->



</body>
</html>
